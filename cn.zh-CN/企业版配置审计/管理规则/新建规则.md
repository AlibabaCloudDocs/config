# 新建规则

规则的本质是放在函数计算服务的函数中的逻辑判断代码，您可以引用企业版配置审计为您准备的托管规则，也可以在函数计算服务中自定义规则函数，还可以使用可视化编辑器零开发的新建自定义规则。

您必须使用企业管理账号登录。

在新建规则之前，您可以先了解[规则的定义及运行原理](/cn.zh-CN/资源合规审计/规则的定义及运行原理.md)。

## 通过托管规则新建规则

企业版配置审计提供的托管规则，请参见[托管规则列表](/cn.zh-CN/资源合规审计/托管规则/托管规则列表.md)。

1.  登录[配置审计控制台](https://config.console.aliyun.com)。

2.  在左侧导航栏，选择**管理合规规则**。

3.  在**管理合规规则**页面，单击**新建规则**。

4.  在**基本设置**页面，选择**规则配置方式**为**使用托管规则**，选择托管规则、风险等级和是否应用到所有成员账号，单击**下一步**。

    ![创建规则-使用预设规则](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8221490061/p97236.png)

5.  在**参数设置**页面，输入规则入参的阈值，单击**提交**。

    **说明：** 规则触发机制、关联资源和入参名称均采用默认值。

6.  如果您在**基本设置**页面，选择将规则应用到所有成员账号，则弹出确认对话框，单击**确定**。该规则将对所有成员账号生效，且该值仅在第一次新建时设置，后续不能修改。

    ![规则应用到所有成员账号确认页面](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6198248951/p97243.png)

7.  查看规则新建结果。

    在**完成**页面，您可以查看规则新建结果。

    -   单击**查看规则详情**，您可以查看当前规则的**基本信息**、**规则触发机制**和**关联资源的合规结果**。
    -   单击**返回规则列表**，您可以在**管理合规规则**列表中查看该条规则，规则状态为**应用中**。

## 通过函数计算新建规则

您可以在函数计算服务中自定义规则函数，请参见[使用函数计算新建规则](/cn.zh-CN/资源合规审计/自定义规则/使用函数计算新建规则.md)。

1.  登录[配置审计控制台](https://config.console.aliyun.com)。

2.  在左侧导航栏，选择**管理合规规则**。

3.  在**管理合规规则**页面，单击**新建规则**。

4.  在**基本设置**页面，选择**规则配置方式**为**通过函数计算**，输入规则名称，选择函数ARN、规则的风险等级和是否应用到所有成员账号，单击**下一步**。

    ![创建规则-通过函数计算](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8221490061/p97246.png)

    请确保您已在函数计算中新建函数，才能直接选择函数，否则请单击**前往创建新的函数**链接，在函数计算控制台上新建函数，操作方法请参见[新建函数](https://help.aliyun.com/document_detail/73338.html)。

5.  在**参数设置**页面，选择规则触发机制和规则关联资源，根据所需设置规则参数，单击**提交**。

    -   选择规则关联的资源后，规则将监听您账号下该资源类型的所有实体资源。一条规则可以关联多个资源类型。
    -   输入**规则入参名称**和**阈值**，入参名称需要跟资源实际的配置名称一致。
6.  如果您在**基本设置**页面，选择将规则应用到所有成员账号，则弹出确认对话框，单击**确定**。该规则将对所有成员账号生效，且该值仅在第一次新建时设置，后续不能修改。

    ![规则应用到所有成员账号确认页面](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6198248951/p97243.png)

7.  查看规则新建结果。

    在**完成**页面，您可以查看规则新建结果。

    -   单击**查看规则详情**，您可以查看当前规则的**基本信息**、**规则触发机制**和**关联资源的合规结果**。
    -   单击**返回规则列表**，您可以在**管理合规规则**列表中查看该条规则，规则状态为**应用中**。

## 通过可视化编辑器新建规则

1.  登录[配置审计控制台](https://config.console.aliyun.com)。

2.  在左侧导航栏，选择**管理合规规则**。

3.  在**管理合规规则**页面，单击**新建规则**。

4.  在**基本设置**页面，选择**规则配置方式**为**通过可视化编辑器**，输入规则名称，选择规则的风险等级和是否应用到所有成员账号，单击**下一步**。

5.  在**参数设置**页面，选择规则关联资源和规则参数，单击**提交**。

6.  如果您在**基本设置**页面，选择将规则应用到所有成员账号，则弹出确认对话框，单击**确定**。该规则将对所有成员账号生效，且该值仅在第一次新建时设置，后续不能修改。

    ![规则应用到所有成员账号确认页面](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/6198248951/p97243.png)

7.  查看规则新建结果。

    在**完成**页面，您可以查看规则新建结果。

    -   单击**查看规则详情**，您可以查看当前规则的**基本信息**、**规则触发机制**和**关联资源的合规结果**。
    -   单击**返回规则列表**，您可以在**管理合规规则**列表中查看该条规则，规则状态为**应用中**。

